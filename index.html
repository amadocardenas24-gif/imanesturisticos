class AdvancedProgressBar {
    constructor(containerId, options = {}) {
        this.container = document.getElementById(containerId);
        this.options = {
            type: 'gradient', // gradient, neon, liquid, particles, circular
            showPercentage: true,
            showText: true,
            autoStart: false,
            duration: 3000,
            ...options
        };
        
        this.progress = 0;
        this.isAnimating = false;
        this.init();
    }
    
    init() {
        this.createHTML();
        if (this.options.autoStart) this.start();
    }
    
    createHTML() {
        this.container.innerHTML = `
            <div class="advanced-progress-container ${this.options.type}">
                <div class="progress-bar" style="width: 0%"></div>
                <div class="progress-info">
                    ${this.options.showText ? '<span class="progress-text">Cargando...</span>' : ''}
                    ${this.options.showPercentage ? '<span class="progress-percent">0%</span>' : ''}
                </div>
            </div>
        `;
        
        this.bar = this.container.querySelector('.progress-bar');
        this.percentElement = this.container.querySelector('.progress-percent');
        this.textElement = this.container.querySelector('.progress-text');
    }
    
    start() {
        this.isAnimating = true;
        const startTime = Date.now();
        
        const animate = () => {
            if (!this.isAnimating) return;
            
            const elapsed = Date.now() - startTime;
            this.progress = Math.min(elapsed / this.options.duration * 100, 100);
            
            this.update();
            
            if (this.progress < 100) {
                requestAnimationFrame(animate);
            } else {
                this.complete();
            }
        };
        
        animate();
    }
    
    update() {
        this.bar.style.width = `${this.progress}%`;
        
        if (this.percentElement) {
            this.percentElement.textContent = `${Math.round(this.progress)}%`;
        }
        
        if (this.textElement) {
            const texts = [
                { min: 0, max: 25, text: "Inicializando..." },
                { min: 25, max: 50, text: "Cargando recursos..." },
                { min: 50, max: 75, text: "Procesando..." },
                { min: 75, max: 100, text: "Finalizando..." }
            ];
            
            const text = texts.find(t => this.progress >= t.min && this.progress <= t.max);
            if (text) this.textElement.textContent = text.text;
        }
    }
    
    complete() {
        this.isAnimating = false;
        if (this.percentElement) this.percentElement.textContent = "Â¡Listo!";
        if (this.textElement) this.textElement.textContent = "Completado";
        
        // Efecto de completado
        this.bar.style.background = "linear-gradient(90deg, #2ecc71, #1abc9c)";
        this.container.classList.add('completed');
        
        // Evento personalizado
        this.container.dispatchEvent(new CustomEvent('progressComplete'));
    }
    
    stop() {
        this.isAnimating = false;
    }
    
    reset() {
        this.progress = 0;
        this.update();
        this.container.classList.remove('completed');
        this.bar.style.background = "";
    }
    
    setProgress(value) {
        this.progress = Math.min(Math.max(value, 0), 100);
        this.update();
    }
}

// Uso:
// const progressBar = new AdvancedProgressBar('loading-container', {
//     type: 'gradient',
//     duration: 5000,
//     autoStart: true
// });
