<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RA Original - Con Marcador</title>
    <!-- Librerías según documentación de MindAR -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

    <style>
        /* Pantalla de inicio con rotación */
        #pantalla-inicio {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 2000; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
        }

        @keyframes girar {
            from { transform: perspective(600px) rotateY(0deg); }
            to { transform: perspective(600px) rotateY(-360deg); }
        }

        #img-portada {
            width: 250px; height: 250px; border-radius: 50%;
            animation: girar 5s linear infinite;
        }

        button {
            margin-top: 20px; padding: 15px 30px; 
            background: #007bff; color: white; border: none; border-radius: 20px;
        }
    </style>
</head>
<body>

    <div id="pantalla-inicio">
        <img id="img-portada" src="./portada.jpg">
        <button id="btn-comenzar">EMPEZAR</button>
    </div>

    <!-- Escena configurada para Image Tracking original -->
    <a-scene mindar-image="imageTargetSrc: ./marker.mind;" 
             vr-mode-ui="enabled: false" 
             device-orientation-permission-ui="enabled: false">
        
        <a-assets>
            <!-- Usando el video 'asset.mp4' visto en tu carpeta ar_experience -->
            <video id="video-original" src="./asset.mp4" loop playsinline crossorigin="anonymous"></video>
        </a-assets>

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <!-- El video ahora está vinculado al marcador, no a la cámara -->
        <a-entity id="target0" mindar-image-target="targetIndex: 0">
            <a-video id="render-video" src="#video-original" 
                     width="1" height="0.55" 
                     position="0 0 0"
                     rotation="0 0 0"></a-video>
        </a-entity>
    </a-scene>

    <script>
        const btn = document.getElementById('btn-comenzar');
        const vid = document.getElementById('video-original');
        const target = document.getElementById('target0');

        btn.onclick = () => {
            document.getElementById('pantalla-inicio').style.display = 'none';
        };

        // El video solo se reproduce cuando se detecta el marcador (targetFound)
        target.addEventListener('targetFound', () => {
            vid.play();
        });

        // El video se pausa si se pierde el marcador
        target.addEventListener('targetLost', () => {
            vid.pause();
        });
    </script>
</body>
</html>
