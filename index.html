<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>RA Animales</title>

<!-- A-Frame y MindAR -->
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
/* ================= PANTALLA DE INICIO ================= */
#pantalla-inicio{
    position:fixed;
    inset:0;
    background:#fff;
    z-index:2000;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
}

#img-portada{
    width:200px;
    height:200px;
    border-radius:50%;
    animation:giro 5s linear infinite;
    margin-bottom:20px;
}

@keyframes giro{
    from{transform:rotateY(0deg);}
    to{transform:rotateY(-360deg);}
}

#contenedor-barra{
    width:260px;
    height:12px;
    background:#eee;
    border-radius:10px;
    overflow:hidden;
}

#barra{
    width:0%;
    height:100%;
    background:#28a745;
    transition:width .3s;
}

#btn-entrar{
    margin-top:20px;
    padding:15px 40px;
    border:none;
    border-radius:50px;
    background:#007bff;
    color:#fff;
    font-size:18px;
    cursor:pointer;
    display:none;
}

/* ================= BOTÓN WHATSAPP ================= */
#btn-whatsapp{
    position:fixed;
    bottom:40px;
    left:50%;
    transform:translateX(-50%);
    width:70px;
    height:70px;
    background:#25d366;
    border-radius:50%;
    display:none;
    justify-content:center;
    align-items:center;
    z-index:1500;
    box-shadow:0 4px 15px rgba(0,0,0,.4);
}
#btn-whatsapp img{width:38px;}
</style>
</head>

<body>

<!-- ================= PANTALLA DE CARGA ================= -->
<div id="pantalla-inicio">
    <img id="img-portada" src="./portada.jpg">
    <div id="contenedor-barra"><div id="barra"></div></div>
    <p id="txt-status">Cargando...</p>
    <button id="btn-entrar">EMPEZAR</button>
</div>

<!-- ================= BOTÓN WHATSAPP ================= -->
<a id="btn-whatsapp" href="https://wa.me/5511969229578" target="_blank">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg">
</a>

<!-- ================= ESCENA AR ================= -->
<a-scene
    mindar-image="imageTargetSrc: ./marker.mind;"
    vr-mode-ui="enabled:false"
    device-orientation-permission-ui="enabled:false"
    embedded>

    <a-assets>
        <!-- Video preparado para autoplay móvil -->
        <video id="videoAsset"
            src="./asset.mp4"
            loop
            muted
            playsinline
            webkit-playsinline
            crossorigin="anonymous">
        </video>
    </a-assets>

    <a-camera position="0 0 0" look-controls="enabled:false"></a-camera>

    <a-entity id="target0" mindar-image-target="targetIndex:0">
        <a-video
            src="#videoAsset"
            width="1"
            height="0.6"
            position="0 0 0"
            material="shader:flat;">
        </a-video>
    </a-entity>

</a-scene>

<script>
/* ================= VARIABLES ================= */
const barra = document.getElementById("barra");
const btnEntrar = document.getElementById("btn-entrar");
const pantalla = document.getElementById("pantalla-inicio");
const btnWA = document.getElementById("btn-whatsapp");
const video = document.getElementById("videoAsset");
const target = document.getElementById("target0");

/* ================= CARGA FAKE ================= */
let carga = 0;
const intervalo = setInterval(()=>{
    carga += 10;
    barra.style.width = carga + "%";
    if(carga >= 100){
        clearInterval(intervalo);
        document.getElementById("txt-status").style.display="none";
        btnEntrar.style.display="block";
    }
},150);

/* ================= ENTRAR ================= */
btnEntrar.onclick = ()=>{
    pantalla.style.display="none";

    // Desbloqueo autoplay móvil
    video.muted = true;
    video.play().catch(()=>{});

    btnWA.style.display="flex";
};

/* ================= EVENTOS AR ================= */
target.addEventListener("targetFound", ()=>{
    video.muted = false;
    video.play();
    btnWA.style.display="flex";
});

target.addEventListener("targetLost", ()=>{
    video.pause();
    btnWA.style.display="none";
});
</script>

</body>
</html>

